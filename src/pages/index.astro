---
import GradientBackgroundLayout from '../layouts/GradientBackgroundLayout.astro';
import SearchBar from '../components/SearchBar.astro';
import UpperLeftWidget from '../components/UpperLeftWidget.astro';
import UpperRightWidget from '../components/UpperRightWidget.astro';
import ShortcutsGrid from '../components/ShortcutsGrid.astro';

import yaml, { YAMLException } from 'js-yaml';
import type { Shortcut } from '../models/Shortcut';

let shortcuts: Shortcut[] | unknown;
try {
  shortcuts = yaml.load(import.meta.env.SHORTCUTS, {
    onWarning: (warning: YAMLException) =>
      console.warn('Yaml loading returned a warning.', warning)
  });
  if (!shortcuts || shortcuts === 'undefined')
    return new Response('Environment variable "SHORTCUTS" is undefined or not in valid yaml', {
      status: 500
    });
} catch (error) {
  console.error('Failed to load yaml shortcuts.', error);
  return new Response('Failed to load yaml shortcuts.', {
    status: 500
  });
}

---

<GradientBackgroundLayout title="Welcome to Astro.">

  <div class="h-full w-full p-4 lg:p-8 xl:p-12 flex flex-col space-y-2 lg:space-y-4 xl:space-y-8">
    <div class="flex flex-col space-y-2 lg:space-y-4 xl:space-y-8">
      <div class="flex flex-row space-x-2">
        <UpperLeftWidget></UpperLeftWidget>
        <div class="flex-auto"></div>
        <UpperRightWidget></UpperRightWidget>
      </div>
      <SearchBar></SearchBar>
    </div>
    <ShortcutsGrid shortcuts={shortcuts as Shortcut[]}></ShortcutsGrid>
  </div>

</GradientBackgroundLayout>
